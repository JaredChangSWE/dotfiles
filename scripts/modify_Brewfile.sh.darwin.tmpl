#!/bin/bash

#
# Install/update packages when Brewfile changes
# This script runs automatically when Brewfile is modified
#

set -euo pipefail

eval "$(/opt/homebrew/bin/brew shellenv)"

BREWFILE_PATH="{{ .chezmoi.sourceDir }}/Brewfile.darwin"

echo "ğŸ“¦ Brewfile.darwin has changed - updating packages..."

# Change to the chezmoi source directory
cd "{{ .chezmoi.sourceDir }}"

# Install all packages using brew bundle
if brew bundle --verbose --file "$BREWFILE_PATH"; then
    echo "âœ… Brewfile.darwin update completed successfully!"
else
    echo "âŒ Some packages failed to install/update. Check the output above."
fi

echo "ğŸ‰ Brewfile.darwin update completed!"
